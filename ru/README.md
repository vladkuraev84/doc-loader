# Введение

> Добро пожаловать в документацию проекта "Loader for Form Builder"! 

Ниже представлена документация, описывающая код проекта. Код написан на TypeScript, и является частью более крупного приложения, связанного с загрузкой и инициализацией виджет-формы. Код документирован ниже для объяснения его целей, функциональности и использования.

## Описание кода

Предоставленный код выполняет следующие шаги:

- Удаление дублированных тегов в HTML.
- Получение формы виджета и извлечение параметров из атрибутов формы.
- Проверка параметров на валидность.
- Получение информации о начале (схемы и локали) для внедрения модулей.
- Отправка данных о схеме и локалях в приложение виджета (Player).
- Сохранение схемы в хранилище для использования при инициализации модулей.
- Инициализация контейнера для файлов DOM.
- Загрузка модулей.
- Внедрение бандлов (пакетов) и стилей.
- Этот код представляет собой точку входа для загрузки и инициализации виджета-формы.

## Корень проекта

### webpack.config.js

Файл **webpack.config.js** содержит настройки для сборки проекта с использованием Webpack. Этот файл определяет, каким образом будут обработаны и объединены различные файлы проекта. В результате сборки будет сформирован бандл (пакет) JavaScript, который можно использовать в веб-приложении. Ниже приведено краткое описание ключевых настроек:

- **entry**: Определяет точку входа для сборки. Это может быть один или несколько файлов, которые будут объединены вместе.
- **output**: Задает параметры для генерации выходных файлов, включая имя и путь к бандлу.
- **module**: Определяет правила обработки различных типов файлов с помощью загрузчиков (loaders). Например, как TypeScript-файлы должны компилироваться в JavaScript.
- **resolve**: Указывает, какие расширения файлов могут быть автоматически разрешены при импорте (например, .js, .ts).

### tsconfig.json

Файл **tsconfig.json** содержит настройки компилятора TypeScript. Он определяет, как TypeScript-код будет компилироваться в JavaScript. Ниже приведено краткое описание некоторых ключевых настроек:

- **"compilerOptions"**: Здесь определяются настройки компилятора, такие как целевая версия JavaScript, путь к выходной директории, использование модулей и другие параметры.
- **"files"**: Файл-точка входа.

### .prettierrc

Файл **.prettierrc** содержит настройки для инструмента Prettier, который предназначен для автоматического форматирования кода. Это помогает сделать код более согласованным и читаемым. В этом файле определяются правила форматирования, такие как отступы, длина строки и другие стилистические аспекты. Рекомендуем оиспользовать конфигурации, прописанные в данном файле для соблюдений правил форматирования для всех разработчиков, которые будут использовать данный проект.

### dist

Директория **dist** представляет собой место, куда собирается (билдиться) основной файл проекта в результате процесса сборки. Внутри этой директории будет находиться собранный бандл **widget-form-loader.min.js**, готовый к использованию в **form-player**.

### src/classes

В директории **src/classes** располагаются файлы, содержащие бизнес-логику приложения, реализующие паттерн **"facade"**. Этот паттерн представляет собой интерфейс, обеспечивающий более удобное взаимодействие с сложной системой.

### src/classes/bundle-injector

Директория **src/classes/bundle-injector** содержит классы, связанные с подключением бандла (**player**) на веб-страницу. Здесь, реализованы методы для динамической загрузки и внедрения бандла в HTML-код страницы.

### src/classes/informator

Внутри директории **src/classes/informator** находятся классы, связанные с получением начальной информации для приложения. Эти классы выполняют задачу извлечения данных, таких как схема (scheme) и локали (locales), которые могут быть использованы в приложении.

### src/classes/modules

Директория **src/classes/modules** содержит файлы, связанные с модулями. Здесь располагаються классы и структуры, которые используются в приложении для реализации различных функций загрузки модулей. Для загрузки **datepicker** используется именно эта директория.

### src/classes/modules/loader

В директории **src/classes/modules/loader** находится функционал, связанный с загрузкой модулей. Здесь находяться классы и методы, которые отвечают за динамическую загрузку файлов, необходимых для работы с модулями.

### Импорт модулей
Импорт модулей в начале кода представляет собой импорт различных классов и типов, которые используются во всем коде. Эти импорты берутся из локальных модулей и используются для построения и выполнения загрузчика виджет-формы.

----------------------------------------------------------------

### Загрузчик Виджет-формы (Widget Form Loader) (src/index.ts)

- FormWorker: Класс, отвечающий за операции, связанные с формой виджета.
- ParamsWorker: Класс, управляющий операциями по обработке и валидации параметров.
- Informator: Класс, предоставляющий информацию, необходимую для внедрения модулей.
- Bridge: Класс для общения между разными частями приложения.
- BundleInjector: Класс, отвечающий за внедрение пакетов (bundles).
- ModulesLoader: Класс для загрузки модулей.
- FormParams: Тип, представляющий параметры виджета-формы.
- StartedInfo: Тип, представляющий информацию, необходимую для начала.
- Store: Класс, ответственный за хранение и управление данными.
- DomLoader: Класс для загрузки DOM-файлов.
- StyleInjector: Класс для внедрения стилей.
- Класс Загрузчика Виджет-формы (WDFL)
- Класс WDFL содержит один статический метод run, который служит входной точкой для запуска загрузчика виджета-формы. Этот метод следует последовательности шагов для загрузки и инициализации виджета-формы:

Удаление дублированных тегов: Метод **FormWorker.deleteDuplicates()** вызывается для удаления дублированных HTML-тегов. Это обеспечивает чистую и последовательную структуру виджета-формы.

Получение элемента формы: Метод **FormWorker.getForm()** получает HTML-элемент, представляющий виджет-форму. Эта форма будет использоваться для извлечения параметров.

Извлечение параметров формы: Метод **ParamsWorker.get(form)** используется для извлечения параметров из HTML-элемента формы. Извлеченные параметры имеют тип **FormParams**.

Проверка параметров: Метод **ParamsWorker.validate(params)** вызывается для проверки извлеченных параметров. Это включает в себя проверку на наличие обязательных полей или определенных ограничений.

Получение информации о начале: Метод **Informator.getStartedInfo(params)** вызывается для получения информации, необходимой для внедрения модулей. Возвращенный объект содержит схему и локали, необходимые для инициализации.

Отправка данных через **Bridge**: Метод **Bridge.send(scheme, locales)** используется для связи данных с приложением виджета (Player) для дальнейшей обработки.

Сохранение схемы: Полученная схема сохраняется в свойстве **Store.scheme**. Эта схема будет использоваться во время инициализации модулей.

Инициализация контейнера файлов: Метод **DomLoader.initFilesContainer()** вызывается для инициализации контейнера для загрузки файлов DOM.

Загрузка модулей: Метод **ModulesLoader.load()** используется для загрузки необходимых модулей для виджета. Этот шаг включает динамическую загрузку скриптов.

Внедрение пакетов: Метод **BundleInjector.inject(params)** вызывается для внедрения пакета (bundle) в виджет. Это включает в себя внедрение дополнительного JavaScript-кода.

Внедрение стилей: Метод **StyleInjector.inject(params)** используется для внедрения стилей в виджет-форму.

### Запуск Загрузчика Виджет-формы

Статический метод **run()** класса **WDFL** вызывается с помощью **WDFL.run().catch(e => console.error(e))**. Это инициирует весь процесс загрузки и инициализации виджета-формы. Любые ошибки, возникающие во время этого процесса, перехватываются и регистрируются в консоли.

Важно отметить, что этот код представляет собой одну входную точку для запуска загрузчика виджета-формы. Фактические реализации классов и методов, которые вызываются, определены в импортированных модулях и не предоставлены в данном кодовом фрагменте.







