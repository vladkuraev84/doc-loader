## Класс `BundleInjector`

> Класс **BundleInjector** предназначен для добавления бандла (пакета) в веб-страницу на основе определенных параметров и условий. В этом разделе будет разъяснено, как класс **BundleInjector** работает и какие методы и свойства он содержит.

### Конструктор

Конструктор класса **BundleInjector** выполняется при создании экземпляра класса. Он принимает массив параметров **params**, представляющих параметры формы. Описание действий, выполняемых в конструкторе:

| Метод / Класс                           | Описание метода                                                                                                                                                                                                           |
|-----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ParamsWorker.hasAnyDevParam(params)     | проверяет наличие параметров на режим `dev` (`data-dev`). Если есть данный параметр, подключение бандла не выполняется. Использование параметра режима `dev` означает, что проект локально развернут в режиме разработки. |
| BundleInjectorDom.isLoaded()            | проверяет, был ли уже добавлен скрипт на страницу. При наличии `script` в узле [filesContainerId](./CONFIG.md) - дополнительная загрузка файлов не выполняется.                                                           |
| ParamsWorker.getInitContentPath(params) | получает путь инициализации контента: `data-path=""`. Если такой путь не определен, то будет выполнена подключение бандла по умолчанию с помощью метода `injectDefaultBundle()`.                                          |
| Bundler                                 | если путь инициализации контента определен, то класс [Bundler](./BUNDLER.md) используется для получения локального URL бандла. Затем генерируется и добавляется узел DOM со скриптом с этим URL.                          |


### Метод `generateScript(bundleUrl: string)`

Этот приватный метод создает и возвращает элемент **script** для инъекции. Он принимает `bundleUrl` - URL бандла, и устанавливает соответствующие атрибуты для этого элемента, такие как `type`, `id`, и `src`. Также он устанавливает обработчик ошибки для случаев, когда скрипт не может быть загружен.

### Метод `injectDefaultBundle()`

Этот приватный метод выполняет инъекцию бандла по умолчанию. В случае, если не удается найти бандл в локальном пути, будет использован бандл по умолчанию. Метод создает и инъектирует скрипт этого бандла, а также выводит предупреждение в консоль.

### Метод `handleError(error: ErrorEvent)`

Этот приватный метод вызывается при возникновении ошибки при загрузке скрипта. Он удаляет ошибочный скрипт и затем выполняет инъекцию бандла по умолчанию. Также, он выводит предупреждение в консоль, сообщая о проблеме с загрузкой бандла.

### Метод `showWarn(localPath: string)`

Этот приватный метод выводит предупреждение в консоль, сообщая о том, что бандл не был найден в локальном пути, и вместо этого используется бандл с сервера.

### Импорты

В начале кода видны импорты различных модулей и классов. Эти импорты описаны в других разделах и представляют собой зависимости этого класса.

```js
import {Bundler} from '@/classes/bundler';
import {BundleInjectorDom} from './bundle-injector-dom';
import {ParamsWorker} from '@/classes/params-worker';
```